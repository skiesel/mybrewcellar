{{template "top.html" .}}

<link rel="stylesheet" type="text/css" href="css/jRating.jquery.css" media="screen" />
<script type="text/javascript" src="js/jRating.jquery.min.js"></script>

<a href="/cellar?id={{ .Cellar.ID }}">back</a>

{{ with .Beer }}

<h1>{{ .Name }}</h1>
<div class="">
	<div class="row">
		<div class="col-lg-3">
			<p>Average Rating: {{ .GetAverageRating }}</p>
			<p>Quantity: {{ .Quantity }}</p>
				{{ if .Brewed }}
					<p>Brewed: {{ .Brewed.ToString }}</p>
				{{ end }}
			<p>Added: {{ .Added.ToString }}</p>
			<p>Age: {{ .GetAgeString }}</p>
		</div>
		<div class="col-lg-9">
		{{ if ne .Notes "" }}
			<p>{{ .Notes }}&quot;</p>
		{{ end }}
		</div>
	</div>
</div>

<h2>Add new tasting note</h2>

<form id="new-cellar-form" method="POST" action="mycellars">
<div class="row">
	<div class="col-lg-12">

			<div class="form-group">
				<label class="col-sm-2 control-label">rating:</label>
				<div class="col-sm-10">
					<input class="form-control" type="text" readonly id="rating" name="rating" />
					<div id="rating-slider"></div>
				</div>
			</div>

			<div class="form-group">
				<label class="col-sm-2 control-label">tasted on:</label>
				<div class="col-sm-10">
					<input class="form-control datepicker" type="text" readonly id="tasted" name="tasted">
				</div>
			</div>

			<div class="form-group">
				<label class="col-sm-2 control-label">notes:</label>
				<div class="col-sm-10">
					<textarea class="form-control" id="notes" name="notes">
					</textarea>
				</div>
			</div>
			
			<div class="form-group" style="text-align:center;">
	      <span class="input-group-btn">
	        <button id="new-cellar-submit" class="btn btn-default" type="button">add!</button>
	      </span>
	    </div>
  </div>
</div>
</form>


<h2>Existing tasting notes</h2><a id="edit-toggle" href="#">(edit)</a>

<div class="row">
	<div class="col-lg-12">
		<div class="list-group">

		  {{ range .Tastings }}
		  	<a href="#" class="list-group-item">
		  		<div class="row">
		    		<div class="col-lg-6">
				    	<p class="list-group-item-text">{{ .Date.ToString }}</p>
				    </div>
						<div class="col-lg-6">
							<span class="remove-icon badge pull-right" style="display:none;"><span class="glyphicon glyphicon-trash"></span></span>
				    	<p class="list-group-item-text">{{ .Notes }}</p>
				    </div>
					</div>
		  	</a>
		  {{ end }}
		</div>
	</div>
</div>

{{ end }}

<script>

	$("#rating-slider").slider({
		range: "min",
		value: 0,
		min: 0,
		max: 10,
		slide: function( event, ui ) {
			$("#rating").val(ui.value);
		}
	});
	$("#quantity").val($("#quantity-slider").slider("value"));

  $(".datepicker").datepicker({
  	"dateFormat": "yy-mm-dd"
  });

	$('#edit-toggle').click(function(e) {
		if($('#edit-toggle').html() === "(edit)") {
			$('#edit-toggle').html("(disable edit)")
			$('.remove-icon').show();
		}
		else {
			$('#edit-toggle').html("(edit)")
			$('.remove-icon').hide();
		}
		e.preventDefault();
	});

	$('.remove-icon').click(removeTasting);
	function removeTasting(e) {
		e.preventDefault();
		// var cellarName = $(this).parent().find('.cellar-name').html();
		// $('#deletecellar').val(cellarName);
		// $('#cellar-name').html(cellarName);
		// $("#delete-warning-link").click();		
	}
</script>

{{template "bottom.html" .}}